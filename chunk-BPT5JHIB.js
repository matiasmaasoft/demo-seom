import{ja as d,k as l,n as u,t as s,va as c,za as t}from"./chunk-PBFQ7HWZ.js";var g=class a{constructor(o){this.router=o}usuarioSignal=s(this.loadUsuario());modoSignal=s(this.loadModo());usuarioActual=this.usuarioSignal.asReadonly();modoActual=this.modoSignal.asReadonly();isLoggedIn=d(()=>this.usuarioSignal()!==null);loadUsuario(){try{let o=localStorage.getItem(t.USUARIO_ACTUAL);return o?JSON.parse(o):null}catch{return null}}loadModo(){try{return localStorage.getItem(t.MODO_ACTUAL)==="comercio"?"comercio":"socio"}catch{return"socio"}}login(o,e){let n=localStorage.getItem(t.USUARIOS);if(!n)return!1;let r=JSON.parse(n).find(i=>(i.email===o||i.nombre.toLowerCase()===o.toLowerCase())&&i.password===e);if(!r)return!1;localStorage.setItem(t.USUARIO_ACTUAL,JSON.stringify(r)),this.usuarioSignal.set(r);let m=this.loadModo();return this.modoSignal.set(m),!0}logout(){localStorage.removeItem(t.USUARIO_ACTUAL),localStorage.removeItem(t.MODO_ACTUAL),this.usuarioSignal.set(null),this.modoSignal.set("socio"),this.router.navigate(["/login"])}setModo(o){localStorage.setItem(t.MODO_ACTUAL,o),this.modoSignal.set(o),o==="socio"?this.router.navigate(["/socio"]):this.router.navigate(["/comercio"])}getUsuarioActual(){return this.usuarioSignal()}getModoActual(){return this.modoSignal()}static \u0275fac=function(e){return new(e||a)(u(c))};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{g as a};
