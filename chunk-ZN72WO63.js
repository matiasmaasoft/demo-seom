import{a as v}from"./chunk-BPT5JHIB.js";import{a as _,b}from"./chunk-BO6ZYFEU.js";import"./chunk-ZW73QO2R.js";import{C as x,I as f,J as u,K as C,L as E,Q as a,R as n,V as l,aa as r,ba as d,ca as g,ja as s,o as p,qa as h,z as m}from"./chunk-PBFQ7HWZ.js";var S=(o,t)=>t.id,I=(o,t)=>t.socioId;function y(o,t){if(o&1&&(a(0,"li",10)(1,"span",11),r(2),n(),a(3,"span",12),r(4),n(),a(5,"span",13),r(6),n()()),o&2){let e=t.$implicit,i=l(2);m(2),d(i.formatFecha(e.fecha)),m(2),g("Socio ",e.socioId),m(2),d(i.formatMonto(e.monto))}}function P(o,t){if(o&1&&(a(0,"ul",8),C(1,y,7,3,"li",10,S),n()),o&2){let e=l();m(),E(e.ventas())}}function D(o,t){o&1&&(a(0,"p",9),r(1,"A\xFAn no hay ventas."),n())}function w(o,t){if(o&1&&(a(0,"li",10)(1,"span",12),r(2),n(),a(3,"span",13),r(4),n(),a(5,"span",14),r(6),n()()),o&2){let e=t.$implicit,i=l(2);m(2),g("Socio ",e.socioId),m(2),d(i.formatMonto(e.total)),m(2),g("",e.items.length," compra(s)")}}function O(o,t){if(o&1&&(a(0,"ul",8),C(1,w,7,3,"li",10,I),n()),o&2){let e=l();m(),E(e.ventasPorSocio())}}function z(o,t){o&1&&(a(0,"p",9),r(1,"Sin compras por socio."),n())}var M=class o{auth=p(v);consumos=p(_);comercios=p(b);comercioId=s(()=>{let t=this.auth.getUsuarioActual();return t?.comercioId?t.comercioId:this.comercios.getAll()[0]?.id??""});comercio=s(()=>this.comercios.getById(this.comercioId()));ventas=s(()=>this.consumos.listarPorComercio(this.comercioId()));totalVendido=s(()=>this.consumos.totalPorComercio(this.comercioId()));ventasPorSocio=s(()=>{let t=this.ventas(),e=new Map;return t.forEach(i=>{let c=e.get(i.socioId);c?(c.total+=i.monto,c.items.push(i)):e.set(i.socioId,{socioId:i.socioId,total:i.monto,items:[i]})}),Array.from(e.values())});formatMonto(t){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(t)}formatFecha(t){return new Date(t).toLocaleDateString("es-AR",{day:"2-digit",month:"2-digit",year:"numeric"})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=x({type:o,selectors:[["app-dashboard-comercio"]],decls:20,vars:4,consts:[[1,"app-container"],[1,"greeting"],[1,"comercio-name"],[1,"card","card-total"],[1,"card-title"],[1,"card-value","total-value"],[1,"card"],[1,"section-title"],[1,"list"],[1,"empty-msg"],[1,"list-item"],[1,"list-date"],[1,"list-detail"],[1,"list-amount"],[1,"list-count"]],template:function(e,i){if(e&1&&(a(0,"div",0)(1,"h1",1),r(2,"Vista Comercio"),n(),a(3,"p",2),r(4),n(),a(5,"section",3)(6,"span",4),r(7,"Monto total vendido"),n(),a(8,"p",5),r(9),n()(),a(10,"section",6)(11,"h2",7),r(12,"Ventas realizadas"),n(),f(13,P,3,0,"ul",8)(14,D,2,0,"p",9),n(),a(15,"section",6)(16,"h2",7),r(17,"Compras por socio"),n(),f(18,O,3,0,"ul",8)(19,z,2,0,"p",9),n()()),e&2){let c;m(4),d(((c=i.comercio())==null?null:c.nombre)??"Comercio"),m(5),d(i.formatMonto(i.totalVendido())),m(4),u(i.ventas().length>0?13:14),m(5),u(i.ventasPorSocio().length>0?18:19)}},dependencies:[h],styles:[".greeting[_ngcontent-%COMP%]{font-size:1.375rem;font-weight:700;margin-bottom:.35rem;color:var(--seom-text)}.comercio-name[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:var(--seom-text-muted);margin-bottom:var(--seom-spacing-section)}.card-total[_ngcontent-%COMP%]{background:linear-gradient(145deg,var(--seom-accent-green) 0%,var(--seom-accent-green-light) 100%);color:#fff;margin-bottom:var(--seom-spacing-section);padding:var(--seom-spacing-card) 1.5rem;box-shadow:0 4px 16px #2d6a4f33}.card-total[_ngcontent-%COMP%]   .card-title[_ngcontent-%COMP%]{color:#fffffff2;font-size:.875rem;font-weight:600}.total-value[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:800;margin:.35rem 0 0;color:#fff;letter-spacing:-.02em}.section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:700;margin-bottom:1rem;margin-top:0;color:var(--seom-text)}.list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.list-item[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;gap:.5rem;padding:1rem 0;border-bottom:1px solid var(--seom-border)}.list-item[_ngcontent-%COMP%]:last-child{border-bottom:none;padding-bottom:0}.list-date[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--seom-text-muted);width:100%}.list-detail[_ngcontent-%COMP%]{flex:1;min-width:0;font-weight:500}.list-amount[_ngcontent-%COMP%]{font-weight:600;color:var(--seom-text)}.list-count[_ngcontent-%COMP%]{font-size:.8125rem;color:var(--seom-text-muted);width:100%}.empty-msg[_ngcontent-%COMP%]{font-size:.875rem;color:var(--seom-text-muted);margin:0}"]})};export{M as DashboardComercioComponent};
